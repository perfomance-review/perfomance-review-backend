## Api приложения

### Получение опросов

`GET /polls&status=STATUS`

`Cookie: user-id=USER_ID`

`status - обязательный параметр c значением из [OPEN, PROGRESS, COMPLETED, CLOSED]`

Возвращает для пользователя с указанным id (USER_ID) массив polls из объектов с полями:

* **pollId** - id опроса
* **title** - название опроса
* **description** - описание опроса
* **deadline** - дедлайн
* **questionsCount** - количество вопросов
* **respondentsCount** - количество респондентов
* **status** - статус

Пример:

Получить активные опросы: 
`GET /polls?status=OPEN&status=PROGRESS`

Получить закрытые опросы
`GET /polls?status=CLOSED`

### Создание опроса

`POST /polls

Пример:

    {
      "name": "Название опроса",
      "description": "Описание опроса",
      "respondentIds": [
          "d993fdae-80e9-441a-a96c-e4033e2af6a1",
          "90d224df-441a-0168-a96c-e4033e2af6a1",
          "873429f8-a96c-999e-a96c-e4033e2af6a1"
      ],
      "questionIds": [
          "90d224df-80e9-441a-a96c-e4033e2af6a1",
          "d993fdae-0168-40aa-82c5-a389bee64cb2",
          "873429f8-0aa7-4d89-999e-0916cb4e821d"
      ],
      "deadline": "2022-08-01"
    }

### Получение информации об опросе

`GET /polls/{poll_id}`

`Cookie: user-id=USER_ID`

Возвращает для пользователя с указанным id (USER_ID) информацию по опросу poll_id:

* **title** - название опроса
* **description** - описание опроса
* **status** - статус
* **questionsCount** - количество вопросов
* **deadline** - дедлайн
* **respondents** - список респондентов
    * **userId** - id пользователя
    * **firstName** - имя пользователя
    * **secondName** - фаммилия пользователя

### Начало опроса

`POST /start/{poll_id}`

`Cookie: user-id=USER_ID`

Тело запроса: массив user_id респондентов, которые остались после фильтрации пользователем 

* меняет статус текущего опроса на **"PROGRESS"**
* записывает в базу данных информацию об исключенных респондентах
* записывает в таблицу compare_pair все возможные сочетания оцениваемых участников по каждому вопросу

### endpoint который отдаёт вопрос и сформированные пары по опросу

`GET /comparepairsofpoll/{poll_id}, где poll_id - Идентификатор текущего опроса `

`Cookie: user-id=USER_ID`

Тело ответа с http кодом 200: 
    
    {
      "pollId": "449fe21d-6916-4486-ba43-47f1055b0f45", //Идентификатор текущего опроса
      "respondentId": 00000000-0000-0000-0000-000000000001", //Идентификатор респондента, совпадает с cookie: user-id=USER_ID
      "questionId": "7b622bd4-c823-4b27-95b1-b4bd372ac900", //Идентификатор вопроса из текущего опроса
      "text": "У кого красивее обои на рабочем столе?", //Текст вопроса из текущего опроса
      "hasNext": "true", //Признак следующего вопроса из текущего опроса
      "pairsOfPollInfo": [
        {
            "person1": {
                "userId": "e0a91a91-df22-4998-81a1-b3f7d68ecd66", //Идентификатор участника 1
                "firstName": "Иван", //имя
                "secondName": "Иванов", //фамилия
                "middleName": "Иванович" //отчество
            },
            "person2": {
                "userId": "9006acd7-eece-45ff-a7c6-7637b0b852dd", //Идентификатор участника 2
                "firstName": "Василий", //имя
                "secondName": "Васильев", //фамилия
                "middleName": "Васильевич" //отчество
            }
        },
        {
            "person1": {
                "userId": "e0a91a91-df22-4998-81a1-b3f7d68ecd66", //Идентификатор участника 1 из второй пары
                "firstName": "Иван", //имя
                "secondName": "Иван", //фамилия
                "middleName": "Иван" //отчество
            },
            "person2": {
                "userId": "9006acd7-eece-45ff-a7c6-7637b0b852dd", //Идентификатор участника 2 из второй пары
                "firstName": "Петр", //имя
                "secondName": "Петров", //фамилия
                "middleName": "Петрович" //отчество
            }
        },
        ...
      ]
    }


### endpoint обновления победителя в паре по конкретному вопросу текущего опроса

`POST /updatewinner`
`Cookie: user-id=USER_ID`

Тело запроса: 

    {
      "pollId": "449fe21d-6916-4486-ba43-47f1055b0f45", //Идентификатор текущего опроса
      "questionId": "7b622bd4-c823-4b27-95b1-b4bd372ac900", //Идентификатор вопроса из текущего опроса
      "person1Id": "e0a91a91-df22-4998-81a1-b3f7d68ecd66", //Идентификатор участника 1
      "person2Id": "9006acd7-eece-45ff-a7c6-7637b0b852dd", //Идентификатор участника 2
      "winnerId": "e0a91a91-df22-4998-81a1-b3f7d68ecd66", //Идентификатор победителя в паре по вопросу, выбран участник 1 
      "isCompleted": "false" // признак завершения всех пар по вопросу у респондента, id респондента получаем из cookie
    }



Ответ: http code 200 с пустым телом:

    { }
   
    В случае ошибки: код 400/500 с телом с информацией по ошибке


* метод обновления победителя в паре по вопросу
* записывает в базу данных информацию о победителе в табл compare_pair




